#### Jmeter学习

 	Apache JMeter是一款纯java编写负载功能测试和性能测试开源工具软件，相比Loadrunner而言，JMeter小巧轻便且免费。

###### 性能测试特色

+  可以对测试静态资源（例如 js、html 等）以及动态资源（例如 php、jsp、ajax 等等）进行性能测试 
+  可以挖掘出系统最大能处理的并发用户数 
+  提供了一系列各种形式的性能分析报告 

###### jmeter一般用于两种类型的性能测试

+ 负载测试： 通过测试系统在资源超负荷情况下的表现，以发现设计上的错误或验证系统的负载能力。 
+  测试系统能承受的最大负载能力。目的在于发挖掘出目标服务系统可以处理的最大负载。 

###### 性能测试基本过程

1. 新增线程组： 创建测试线程组，并设置线程数量及线程初始化启动方式。 
2. 新增JMeter原组： 创建各种默认元组及测试元组，填入目标测试静态资源请求和动态资源请求参数及数据。 
3. 新增监听器： 创建各种形式的结果搜集元组，以便在运行过程及运行结束后搜集监控指标数据。 
4. 运行&查看结果： 调试运行，分析指标数据，挖掘性能瓶颈、评估系统性能状态 。

###### 常用术语统一

+ 元件：jmeter工具菜单的一个子菜单（功能）
+ 组件：一组元件的集合

###### jmeter测试计划要素

1. 脚本中测试计划只能有一个
2. 测试计划中至少有一个线程组
3. 至少要有一个取样器
4. 至少有一个监听器

+ 测试计划：顶级菜单，代表一个测试计划
+ 线程组：
  1. 代表一个要测试的场景（各种相关的交易集合），对于性能测试来说可以指定多少个用户完成这个场景的内容；
  2. 模拟大量用户负载，可以设置运行的线程数等（就是模拟多少用户，一线程一用户）
  3. 访问路径：测试计划->线程组
+ 控制器：
  1. 挂在线程组下，用来控制各种交易（接口）的调用频率，有循环控制器、简单控制器等；
  2. 访问路径：测试计划->线程组->逻辑控制器

###### jmeter执行顺序

​	配置元件->前置处理器->定时器->取样器->后置处理器->断言->监听器

1. 配置元件：
   + 为取样器提供预备数据，然后由取样器发出请求。如大量用户并发时的参数化等 
   + 访问路径：测试计划->配置元件
2. 前置处理器：
   +  为取样器提供数据支持，取样器访问前可以做这一下操作，比如说参数化
   + 访问路径：测试计划->前置处理器
3. 定时器：
   +  如模拟用户负载，将多个请求在同一时刻发送 
   + 访问路径：测试计划->线程组->定时器
4. 取样器： 
   + 模拟用户操作，向服务器发送请求以及接收服务器的响应数据；代表一次发起请求和接受响应的元件，这里可以认为是一个接口、交易、请求
   + 访问路径：测试计划->线程组->Sampler
5. 后置处理器：
   + 对取样器的响应数据做处理
   + 访问路径：测试计划->后置处理器
6. 断言：
   + 验证结果是否正确；常用的是响应断言
   + 访问路径：测试计划->断言
7. 监听器：
   + 收集测试结果
   + 访问路径：测试计划->监听器

###### jmeter其他组件

1. Test Fragment
   + 把业务封装成一个方法供模块控制器调用
   + 访问路径：测试计划->Test Fragment
2. Non Test Elements
   + 可以使用代理服务器录制脚本 
   + 访问路径：测试计划->Non-Test Element

#### 导出性能测试报告

1. 进入jmeter安装目录下的bin目录
2. 在此目录下进入命令行
3.  .\jmeter -n -t E:\jmeter\LoginApiTest.jmx -l .\testplan\result\testLoginLogFile -e -o .\testplan\webreport\LoginReport\
   + ```E:\jmeter\LoginApiTest.jmx```测试计划文件路径
   + `.\testplan\result\testLoginLogFile`测试结果文件路径
   + `.\testplan\webreport\LoginReport\`web报告保存路径
4.  每次导出数据时，需删掉上一次报告数据，即，删掉bin文件下的testLoginLogFile，以及清除output文件下的所有数据，否则会报错 。